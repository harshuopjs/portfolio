import{u as K,G as U,H,x as z,D as k,I as Q,J as X,m as y,v as Y,K as V,q as C,L as Z,f as _,g as ee}from"./CJ2vBQ3b.js";function te(e,t){const{title:u,titleTemplate:m,...a}=e;return K({title:u,titleTemplate:m,_flatMeta:a},{...t,transform(f){const i=U({...f._flatMeta});return delete f._flatMeta,{...f,meta:i}}})}function w(e){return Q()?(X(e),!0):!1}const E=typeof window<"u"&&typeof document<"u",x=typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope,ne=Object.prototype.toString,oe=e=>ne.call(e)==="[object Object]",me=(e,t,u)=>Math.min(u,Math.max(t,e)),ue=()=>{};function N(e){return Array.isArray(e)?e:[e]}function ae(...e){if(e.length!==1)return Y(...e);const t=e[0];return typeof t=="function"?V(Z(()=>({get:t,set:ue}))):C(t)}function $(e,t=1e3,u={}){const{immediate:m=!0,immediateCallback:a=!1}=u;let f=null;const i=H(!1);function l(){f&&(clearInterval(f),f=null)}function n(){i.value=!1,l()}function o(){const s=y(t);s<=0||(i.value=!0,a&&e(),l(),i.value&&(f=setInterval(e,s)))}if(m&&E&&o(),z(t)||typeof t=="function"){const s=k(t,()=>{i.value&&E&&o()});w(s)}return w(n),{isActive:i,pause:n,resume:o}}function le(e,t,u){return k(e,t,{...u,immediate:!0})}const B=E?window:void 0;function re(e){var t;const u=y(e);return(t=u==null?void 0:u.$el)!=null?t:u}function ie(...e){const t=[],u=()=>{t.forEach(l=>l()),t.length=0},m=(l,n,o,s)=>(l.addEventListener(n,o,s),()=>l.removeEventListener(n,o,s)),a=_(()=>{const l=N(y(e[0])).filter(n=>n!=null);return l.every(n=>typeof n!="string")?l:void 0}),f=le(()=>{var l,n;return[(n=(l=a.value)==null?void 0:l.map(o=>re(o)))!=null?n:[B].filter(o=>o!=null),N(y(a.value?e[1]:e[0])),N(ee(a.value?e[2]:e[1])),y(a.value?e[3]:e[2])]},([l,n,o,s])=>{if(u(),!(l!=null&&l.length)||!(n!=null&&n.length)||!(o!=null&&o.length))return;const v=oe(s)?{...s}:s;t.push(...l.flatMap(c=>n.flatMap(p=>o.map(b=>m(c,p,b,v)))))},{flush:"post"}),i=()=>{f(),u()};return w(u),i}function se(e,t={}){const{immediate:u=!0,fpsLimit:m=void 0,window:a=B,once:f=!1}=t,i=H(!1),l=_(()=>m?1e3/y(m):null);let n=0,o=null;function s(p){if(!i.value||!a)return;n||(n=p);const b=p-n;if(l.value&&b<l.value){o=a.requestAnimationFrame(s);return}if(n=p,e({delta:b,timestamp:p}),f){i.value=!1,o=null;return}o=a.requestAnimationFrame(s)}function v(){!i.value&&a&&(i.value=!0,n=0,o=a.requestAnimationFrame(s))}function c(){i.value=!1,o!=null&&a&&(a.cancelAnimationFrame(o),o=null)}return u&&v(),w(c),{isActive:V(i),pause:c,resume:v}}function de(e={}){const{controls:t=!1,interval:u="requestAnimationFrame"}=e,m=C(new Date),a=()=>m.value=new Date,f=u==="requestAnimationFrame"?se(a,{immediate:!0}):$(a,u,{immediate:!0});return t?{now:m,...f}:m}const j="ping";function W(e){return e===!0?{}:e}function ve(e,t={}){const{onConnected:u,onDisconnected:m,onError:a,onMessage:f,immediate:i=!0,autoConnect:l=!0,autoClose:n=!0,protocols:o=[]}=t,s=C(null),v=C("CLOSED"),c=C(),p=ae(e);let b,O,S=!1,M=0,R=[],A,D;const q=()=>{if(R.length&&c.value&&v.value==="OPEN"){for(const r of R)c.value.send(r);R=[]}},J=()=>{A!=null&&(clearTimeout(A),A=void 0)},G=()=>{clearTimeout(D),D=void 0},T=(r=1e3,d)=>{J(),!(!E&&!x||!c.value)&&(S=!0,G(),b==null||b(),c.value.close(r,d),c.value=void 0)},P=(r,d=!0)=>!c.value||v.value!=="OPEN"?(d&&R.push(r),!1):(q(),c.value.send(r),!0),I=()=>{if(S||typeof p.value>"u")return;const r=new WebSocket(p.value,o);c.value=r,v.value="CONNECTING",r.onopen=()=>{v.value="OPEN",M=0,u==null||u(r),O==null||O(),q()},r.onclose=d=>{if(v.value="CLOSED",m==null||m(r,d),!S&&t.autoReconnect&&(c.value==null||r===c.value)){const{retries:h=-1,delay:g=1e3,onFailed:F}=W(t.autoReconnect);typeof h=="number"&&(h<0||M<h)?(M+=1,A=setTimeout(I,g)):typeof h=="function"&&h()?A=setTimeout(I,g):F==null||F()}},r.onerror=d=>{a==null||a(r,d)},r.onmessage=d=>{if(t.heartbeat){G();const{message:h=j,responseMessage:g=h}=W(t.heartbeat);if(d.data===y(g))return}s.value=d.data,f==null||f(r,d)}};if(t.heartbeat){const{message:r=j,interval:d=1e3,pongTimeout:h=1e3}=W(t.heartbeat),{pause:g,resume:F}=$(()=>{P(y(r),!1),D==null&&(D=setTimeout(()=>{T(),S=!1},h))},d,{immediate:!1});b=g,O=F}n&&(E&&ie("beforeunload",()=>T(),{passive:!0}),w(T));const L=()=>{!E&&!x||(T(),S=!1,M=0,I())};return i&&L(),l&&k(p,L),{data:s,status:v,close:T,send:P,open:L,ws:c}}const fe={};function pe(e){e.image,te({title:e.title})}export{ve as a,me as c,pe as d,de as u};
